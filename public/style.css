        :root {
      --sp-green: #1ed760;
      --sp-green-light: #1fdf64;
      --sp-black: #000000;
      --sp-dark-gray: #121212;
      --sp-card-bg: #181818;
      --sp-card-hover: #282828;
      --sp-light-gray: #b3b3b3;
      --sp-white: #ffffff;
      --player-height: 90px;
      --nav-height: 65px;
      --font-stack: 'Circular Std', -apple-system, BlinkMacSystemFont, Roboto, Helvetica, Arial, sans-serif;
    }

    * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
    
    body {
      margin: 0;
      background: var(--sp-black);
      color: var(--sp-white);
      font-family: var(--font-stack);
      overflow: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
      user-select: none;
    }

    /* --- UTILITÁRIOS --- */
    .hidden { display: none !important; }
    .flex { display: flex; }
    .flex-col { display: flex; flex-direction: column; }
    .center { display: flex; align-items: center; justify-content: center; }
    .text-truncate { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .pointer { cursor: pointer; }
    .text-green { color: var(--sp-green) !important; }

    /* LOADING SPINNER */
    .loader-container { display: flex; justify-content: center; align-items: center; padding: 40px; width: 100%; }
    .loader {
      width: 30px; height: 30px; 
      border: 3px solid rgba(255,255,255,0.1); 
      border-top: 3px solid var(--sp-green); 
      border-radius: 50%; 
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* TOAST NOTIFICATION */
    #toast-container {
        position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
        z-index: 5000; pointer-events: none;
    }
    .toast {
        background: #2e77d0; color: #fff; padding: 12px 24px; border-radius: 4px;
        margin-bottom: 10px; font-size: 14px; font-weight: 400;
        box-shadow: 0 4px 12px rgba(0,0,0,0.5); opacity: 0; transition: opacity 0.3s, transform 0.3s;
        transform: translateY(20px); text-align: center;
    }
    .toast.show { opacity: 1; transform: translateY(0); }
    .toast.error { background: #e91429; }
    .toast.success { background: #1ed760; color: #000; }

    /* --- LAYOUT PRINCIPAL --- */
    #main-wrapper { 
        display: flex; 
        flex: 1; 
        overflow: hidden; 
        position: relative; 
        width: 100%;
    }

    /* Sidebar (Desktop) */
    #sidebar {
      width: 280px;
      display: flex; flex-direction: column;
      padding: 8px; gap: 8px;
      background: #000; 
      height: 100%;
      flex-shrink: 0;
    }

    .sidebar-block {
        background: var(--sp-dark-gray); border-radius: 8px;
        padding: 16px 24px; display: flex; flex-direction: column;
    }

    .logo { 
        padding-bottom: 20px; font-size: 24px; font-weight: 700; 
        display: flex; align-items: center; gap: 10px; color: #fff; letter-spacing: -1px;
    }
    .logo img { height: 32px; width: auto; object-fit: contain; }
    
    .nav-btn {
      display: flex; align-items: center; gap: 20px; padding: 10px 0;
      color: var(--sp-light-gray); font-weight: 700; cursor: pointer; transition: 0.2s; font-size: 16px;
    }
    .nav-btn:hover { color: var(--sp-white); }
    .nav-btn.active { color: var(--sp-white); }
    .nav-btn i { font-size: 22px; width: 24px; display: flex; justify-content: center; }
    
    .library-header {
        display: flex; justify-content: space-between; align-items: center;
        color: var(--sp-light-gray); font-weight: 700; margin-bottom: 12px;
        padding-left: 8px;
    }
    .library-header span { display: flex; align-items: center; gap: 12px; cursor: pointer; transition: 0.2s; }
    .library-header span:hover { color: #fff; }
    .library-header i:hover { color: #fff; transform: scale(1.05); background: #2a2a2a; border-radius: 50%; }
    .library-header .fa-plus { padding: 5px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; }

    .library-scroll {
      flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 2px;
      margin-top: 5px; min-height: 0; height: 100%; padding-bottom: 20px; 
    }
    
    .playlist-item {
      padding: 8px; font-size: 14px; color: #b3b3b3; cursor: pointer; border-radius: 6px;
      display: flex; align-items: center; gap: 12px; transition: background 0.1s;
    }
    .playlist-item img { width: 48px; height: 48px; border-radius: 4px; background: #333; object-fit: cover; box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
    .playlist-item:hover { background: #1a1a1a; color: #fff; }
    .playlist-item.active-pl { background: #232323; color: #fff; }
    .pl-info-side { overflow: hidden; flex: 1; }
    .pl-info-side h4 { margin: 0; font-weight: 400; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 15px; }
    .pl-info-side p { margin: 0; font-size: 13px; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* Conteúdo Central */
    #content {
      flex: 1;
      background: linear-gradient(180deg, #202020 0%, #121212 300px);
      overflow-y: auto; 
      margin: 8px 8px 8px 0;
      border-radius: 8px;
      padding: 0 24px;
      position: relative;
      padding-bottom: 40px; 
    }
    
    /* HEADER TRANSPARENTE / STICKY */
    .top-bar {
        display: flex; justify-content: space-between; align-items: center;
        position: sticky; top: 0; z-index: 40;
        height: 64px; margin: 0 -24px 20px -24px; padding: 0 24px;
        background-color: rgba(18, 18, 18, 0); 
        transition: background-color 0.3s ease;
    }
    .top-bar.scrolled { background-color: rgba(18, 18, 18, 1); box-shadow: 0 4px 20px rgba(0,0,0,0.4); }

    .top-bar-nav { display: flex; gap: 8px; }
    .back-btn { 
        width: 32px; height: 32px; border-radius: 50%; background: rgba(0,0,0,0.7); 
        display: flex; align-items: center; justify-content: center; color: #fff; cursor: pointer; 
        border: none; transition: 0.1s;
    }
    .back-btn:hover:not(.disabled) { transform: scale(1.05); background: rgba(0,0,0,0.9); }
    .back-btn.disabled { opacity: 0.5; cursor: not-allowed; }

    .user-pill {
        background: rgba(0,0,0,0.7); padding: 2px 2px 2px 2px; border-radius: 20px;
        display: flex; align-items: center; gap: 8px; cursor: pointer; font-weight: 700; font-size: 14px;
        transition: 0.2s; position: relative; margin-left: auto; padding-right: 12px;
    }
    .user-pill:hover { background: #282828; }
    .user-avatar { width: 28px; height: 28px; border-radius: 50%; background: #535353; display: flex; center; justify-content: center; align-items: center; }
    
    .user-menu-dropdown {
        position: absolute; top: 45px; right: 0; background: #282828; 
        border-radius: 4px; padding: 4px; width: 180px; box-shadow: 0 16px 24px rgba(0,0,0,0.5);
        display: none; flex-direction: column; z-index: 100;
    }
    .user-menu-dropdown.active { display: flex; }
    .um-item { padding: 10px 12px; font-size: 13px; color: #eee; cursor: pointer; text-align: left; border-radius: 2px; }
    .um-item:hover { background: #3e3e3e; }

    /* CTA LOGIN CARD */
    .login-cta {
        background: linear-gradient(90deg, #af2896, #509bf5);
        border-radius: 8px; padding: 16px 24px; margin-bottom: 24px;
        display: flex; justify-content: space-between; align-items: center;
    }
    .login-cta h3 { margin: 0; font-size: 18px; }
    .login-cta p { margin: 4px 0 0; font-size: 13px; opacity: 0.9; }
    .login-btn-white {
        background: #fff; color: #000; border: none; padding: 12px 32px;
        border-radius: 50px; font-weight: 700; cursor: pointer; font-size: 15px;
        transform: scale(1); transition: 0.1s; margin-left: auto;
    }
    .login-btn-white:hover { transform: scale(1.04); background: #f2f2f2; }

    /* --- SCROLLBAR DISFARÇADA --- */
    ::-webkit-scrollbar { width: 12px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background-color: rgba(255,255,255,0.1); border-radius: 10px; border: 3px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background-color: rgba(255,255,255,0.3); }

    /* --- VIEWS --- */
    .view { display: none; animation: fadeIn 0.4s ease; }
    .view.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    h2 { font-size: 24px; margin-bottom: 20px; font-weight: 700; letter-spacing: -0.5px; }
    h3 { font-size: 20px; margin-bottom: 16px; font-weight: 700; }

    /* SEÇÃO DE GÊNEROS */
    .genre-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 24px;
        margin-bottom: 40px;
    }
    .genre-card {
        height: 180px;
        border-radius: 8px;
        position: relative;
        overflow: hidden;
        cursor: pointer;
        transition: transform 0.2s ease;
    }
    .genre-card:hover { transform: scale(1.02); }
    .genre-title {
        font-size: 24px; font-weight: 700; padding: 20px;
        position: absolute; top: 0; left: 0; width: 100%; word-break: break-word;
    }
    .genre-img {
        position: absolute; bottom: 0; right: 0;
        width: 100px; height: 100px;
        transform: rotate(25deg) translate(18%, -2%);
        box-shadow: -2px 2px 10px rgba(0,0,0,0.3);
        display: flex; align-items: center; justify-content: center;
        background: rgba(0,0,0,0.2);
    }
    .genre-img i { font-size: 50px; }


    /* GRID DE CARDS */
    .grid { 
        display: grid; 
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
        gap: 24px; 
    }
    
    .card {
      background: var(--sp-card-bg); padding: 16px; border-radius: 8px;
      transition: background 0.3s ease; cursor: pointer; position: relative;
      display: flex; flex-direction: column; overflow: hidden; isolation: isolate;
    }
    .card:hover { background: var(--sp-card-hover); }
    .card img { 
        width: 100%; aspect-ratio: 1; object-fit: cover; border-radius: 4px; margin-bottom: 16px; 
        box-shadow: 0 8px 24px rgba(0,0,0,0.5); 
    }
    .card-title { font-weight: 700; margin-bottom: 8px; font-size: 16px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #fff; }
    .card-desc { color: var(--sp-light-gray); font-size: 13px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.5; font-weight: 400; }

    .play-btn-hover {
      position: absolute; bottom: 105px; right: 24px;
      width: 48px; height: 48px; border-radius: 50%;
      background: var(--sp-green); color: #000;
      display: flex; align-items: center; justify-content: center;
      font-size: 20px; box-shadow: 0 8px 8px rgba(0,0,0,0.3);
      opacity: 0; transform: translateY(10px); transition: all 0.3s ease; z-index: 10;
    }
    .card:hover .play-btn-hover { opacity: 1; transform: translateY(0); }
    .play-btn-hover:hover { transform: scale(1.1) !important; background: var(--sp-green-light); }

    /* LISTA DE MÚSICAS */
    .track-list-item {
      display: grid; grid-template-columns: 40px 50px 1fr 40px 60px; 
      align-items: center; padding: 8px 16px; border-radius: 4px; cursor: pointer;
      transition: background 0.2s; position: relative; color: #b3b3b3; font-size: 14px;
      margin: 0 -16px;
    }
    .track-list-item:hover { background: rgba(255,255,255,0.1); color: #fff; }
    .track-list-item img { width: 40px; height: 40px; border-radius: 4px; object-fit: cover; }
    .track-list-item:hover .track-num { display: none; }
    .track-list-item:hover .track-play-icon { display: block; }
    
    .track-num { font-size: 14px; }
    .track-play-icon { display: none; color: #fff; font-size: 14px; }
    
    .track-list-item .meta { padding-left: 12px; overflow: hidden; display: flex; flex-direction: column; justify-content: center; min-width: 0; }
    .track-title { color: #fff; font-size: 16px; font-weight: 400; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .track-artist { font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; transition: 0.2s; }
    .track-list-item:hover .track-artist { color: #fff; }
    .track-list-item:hover .track-title { color: #fff; }
    .text-green { color: var(--sp-green) !important; }
    
    /* MOBILE LIBRARY LIST */
    .mobile-lib-item {
        display: flex; align-items: center; gap: 15px; padding: 10px 0; border-bottom: 0px solid #282828; cursor: pointer;
    }
    .mobile-lib-item:active { opacity: 0.7; }
    .mobile-lib-img { width: 56px; height: 56px; border-radius: 4px; display: flex; center; justify-content: center; background: #333; flex-shrink: 0; overflow: hidden; }
    .mobile-lib-img img { width: 100%; height: 100%; object-fit: cover; }
    .mobile-lib-info { overflow: hidden; flex: 1; }
    .mobile-lib-info h4 { margin: 0; color: #fff; font-size: 16px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .mobile-lib-info p { margin: 4px 0 0; color: #b3b3b3; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* PLAYLIST HEADER */
    .pl-header {
        display: flex; align-items: flex-end; gap: 24px; padding: 20px 0 24px;
        background: linear-gradient(transparent 0, rgba(0,0,0,0.5) 100%);
        flex-wrap: wrap; isolation: isolate;
    }
    .pl-cover-large {
        width: 232px; height: 232px; box-shadow: 0 4px 60px rgba(0,0,0,0.5);
        display: flex; align-items: center; justify-content: center; background: #282828;
        font-size: 64px; color: #7f7f7f; flex-shrink: 0;
        overflow: hidden; border-radius: 4px;
    }
    .pl-cover-large img { width: 100%; height: 100%; object-fit: cover; }
    .pl-details { flex: 1; overflow: hidden; min-width: 200px; display: flex; flex-direction: column; justify-content: flex-end; }
    .pl-type { font-size: 12px; font-weight: 700; text-transform: uppercase; margin-bottom: 8px; }
    .pl-name { font-size: clamp(32px, 6vw, 96px); font-weight: 900; margin: 0 0 12px; line-height: 1; letter-spacing: -2px; word-break: break-word; }
    .pl-meta { display: flex; align-items: center; gap: 4px; font-size: 14px; color: #fff; font-weight: 500; }

    /* SEARCH */
    .search-header { position: sticky; top: 0; z-index: 50; padding: 10px 0 20px; background: inherit; }
    .search-bar { background: #2a2a2a; border-radius: 500px; padding: 12px 20px; color: #b3b3b3; display: flex; align-items: center; width: 100%; max-width: 360px; border: 2px solid transparent; transition: 0.2s; }
    .search-bar:focus-within { background: #333; border: 2px solid #fff; color: #fff; box-shadow: 0 0 10px rgba(255,255,255,0.1); }
    .search-bar input { border: none; font-weight: 400; width: 100%; margin-left: 10px; font-size: 14px; background: transparent; color: inherit; height: 100%; }

    /* --- PLAYER BAR --- */
    #player-bar {
      position: relative; 
      bottom: auto; left: auto; right: auto;
      height: var(--player-height);
      background: #181818; 
      border-top: 1px solid #282828;
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 16px; 
      z-index: 200;
      width: 100%;
      flex-shrink: 0;
    }
    .player-left { display: flex; align-items: center; width: 30%; min-width: 180px; }
    .player-left img { width: 56px; height: 56px; margin-right: 14px; border-radius: 4px; object-fit: cover; box-shadow: 0 2px 4px rgba(0,0,0,0.5); }
    .current-info { overflow: hidden; display: flex; flex-direction: column; justify-content: center; margin-right: 15px; }
    .current-info h4 { margin: 0; font-size: 14px; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; cursor: pointer; }
    .current-info h4:hover { text-decoration: underline; }
    .current-info p { margin: 0; font-size: 11px; color: #b3b3b3; margin-top: 2px; cursor: pointer; }
    .current-info p:hover { text-decoration: underline; color: #fff; }

    .player-center { width: 40%; display: flex; flex-direction: column; align-items: center; max-width: 722px; }
    .controls { display: flex; align-items: center; gap: 20px; margin-bottom: 8px; }
    .controls i { font-size: 16px; color: #b3b3b3; cursor: pointer; transition: 0.2s; display: flex; justify-content: center; align-items: center; }
    .controls i:hover { color: #fff; }
    .controls i.active-control { color: var(--sp-green); position: relative; }
    .controls i.active-control::after { content: '.'; position: absolute; bottom: -8px; font-size: 20px; color: var(--sp-green); }
    
    .play-icon { font-size: 16px; color: #000; background: #fff; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: 0.2s; position: relative; }
    .play-icon:hover { transform: scale(1.05); background: #f0f0f0; }

    /* LOADING SPINNER IN PLAYER */
    .play-icon.buffering::after, .fp-play.buffering::after {
        content: ''; position: absolute; top:0; left:0; right:0; bottom:0;
        border-radius: 50%; border: 3px solid transparent;
        border-top-color: var(--sp-green); border-right-color: var(--sp-green);
        animation: spin 0.8s linear infinite;
    }
    .play-icon.buffering i, .fp-play.buffering i { opacity: 0; }
    .mobile-mini-play.buffering {
        color: transparent !important;
        position: relative;
    }
    .mobile-mini-play.buffering::after {
        content: ''; position: absolute; top: 0; left: 0;
        width: 100%; height: 100%;
        border-radius: 50%; border: 2px solid transparent;
        border-top-color: #fff; border-right-color: #fff;
        animation: spin 0.8s linear infinite;
    }


    .progress-container { width: 100%; display: flex; align-items: center; gap: 8px; font-size: 11px; color: #b3b3b3; font-family: monospace; }
    
    .sp-range {
      -webkit-appearance: none; width: 100%; height: 4px; background: transparent; cursor: pointer;
      position: relative; border-radius: 2px;
    }
    .sp-range:focus { outline: none; }
    /* Atualizado para suportar buffer visual */
    .sp-range::-webkit-slider-runnable-track {
      width: 100%; height: 4px; border-radius: 2px;
      background: linear-gradient(90deg, #b3b3b3 var(--progress-percent, 0%), #555 var(--progress-percent, 0%) var(--buffered-percent, 0%), #4d4d4d var(--buffered-percent, 0%));
    }
    .sp-range::-webkit-slider-thumb {
      -webkit-appearance: none; height: 12px; width: 12px; border-radius: 50%; background: #fff;
      margin-top: -4px; box-shadow: 0 2px 4px rgba(0,0,0,0.5); 
      transform: scale(0); transition: transform 0.1s ease;
    }
    .progress-container:hover .sp-range::-webkit-slider-runnable-track {
        background: linear-gradient(90deg, var(--sp-green) var(--progress-percent, 0%), #555 var(--progress-percent, 0%) var(--buffered-percent, 0%), #4d4d4d var(--buffered-percent, 0%));
    }
    .progress-container:hover .sp-range::-webkit-slider-thumb { transform: scale(1); }
    .sp-range:active::-webkit-slider-thumb { transform: scale(1); }

    .player-right { width: 30%; display: flex; justify-content: flex-end; align-items: center; gap: 12px; position: relative; }
    .player-right i { color: #b3b3b3; font-size: 16px; display: flex; justify-content: center; cursor: pointer; }
    .player-right i:hover { color: #fff; }
    .vol-wrapper { display: flex; align-items: center; width: 100px; }

    /* MOBILE NAV & PLAYER */
    #mobile-nav {
      display: none; position: fixed; bottom: 0; left: 0; right: 0;
      height: var(--nav-height); background: linear-gradient(180deg, rgba(18,18,18,0.9) 0%, #000 100%);
      backdrop-filter: blur(10px);
      justify-content: space-around; align-items: center; z-index: 201; border-top: 1px solid #282828;
      padding-bottom: env(safe-area-inset-bottom);
    }
    .mobile-item { display: flex; flex-direction: column; align-items: center; font-size: 10px; color: #b3b3b3; cursor: pointer; padding: 5px; flex: 1;}
    .mobile-item i { font-size: 22px; margin-bottom: 4px; transition: 0.2s; }
    .mobile-item.active { color: #fff; }
    .mobile-item:active i { transform: scale(0.9); }

    #full-player {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #121212;
      z-index: 1000; display: flex; flex-direction: column; padding: 40px 24px 100px;
      transform: translateY(100%); transition: transform 0.35s cubic-bezier(0.2, 0, 0, 1);
      overflow-y: auto; will-change: transform;
    }
    #full-player.open { transform: translateY(0); }
    .fp-art { width: 100%; aspect-ratio: 1; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.6); margin-bottom: 30px; object-fit: cover; }
    .fp-controls { display: flex; flex-direction: column; gap: 20px; width: 100%; margin-top: auto; }
    .fp-main-btns { display: flex; align-items: center; justify-content: space-between; margin-top: 10px; }
    .fp-play { width: 64px; height: 64px; border-radius: 50%; background: #fff; color: #000; display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; transition: 0.1s; position: relative; }
    .fp-play:active { transform: scale(0.95); background: #ccc; }

    /* MODALS */
    .modal-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8); z-index: 2000;
      display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px);
    }
    .modal-box {
      background: #282828; padding: 32px; border-radius: 8px; width: 90%; max-width: 400px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5); text-align: center;
      animation: modalUp 0.3s ease;
    }
    @keyframes modalUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    .sp-input { width: 100%; padding: 12px; background: #3e3e3e; border: 1px solid transparent; border-radius: 4px; color: #fff; margin: 10px 0; font-size: 14px; font-weight: 500; transition: 0.2s; }
    .sp-input:focus { background: #333; outline: 1px solid #fff; border-color: #555; }
    
    .sp-btn { border: none; padding: 14px 32px; border-radius: 50px; font-weight: 700; cursor: pointer; font-size: 14px; text-transform: uppercase; transition: 0.1s; margin-top: 10px; letter-spacing: 1px; }
    .sp-btn-primary { background: var(--sp-green); color: #000; width: 100%; }
    .sp-btn-primary:hover { transform: scale(1.02); background: var(--sp-green-light); }
    .sp-btn-google { background: #fff; color: #333; width: 100%; margin-top: 8px; display: flex; align-items: center; justify-content: center; gap: 8px; text-transform: none; }
    .sp-btn-google:hover { background: #f1f1f1; }
    .sp-btn-sec { background: transparent; color: #b3b3b3; text-transform: none; }
    .sp-btn-sec:hover { color: #fff; }
    .sp-btn-danger { background: transparent; color: #e91429; border: 1px solid rgba(233,20,41,0.3); }
    .sp-btn-danger:hover { border: 1px solid #e91429; color: #fff; }
    .modal-link { margin-top: 15px; color: #b3b3b3; font-size: 13px; cursor: pointer; text-decoration: underline; }

    /* EDIT MODAL */
    #modal-edit-pl .modal-box { max-width: 520px; display: flex; flex-direction: column; }
    .edit-grid { display: flex; gap: 20px; align-items: flex-start; text-align: left; }
    .edit-cover-wrapper {
        width: 180px; height: 180px; background: #333; 
        box-shadow: 0 4px 15px rgba(0,0,0,0.5); position: relative;
        display: flex; align-items: center; justify-content: center;
        flex-shrink: 0;
    }
    .edit-cover-wrapper img { width: 100%; height: 100%; object-fit: cover; }
    .edit-cover-wrapper:hover .edit-overlay { opacity: 1; }
    .edit-overlay {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.7); display: flex; flex-direction: column;
        align-items: center; justify-content: center; opacity: 0; transition: 0.2s;
        cursor: pointer; color: #fff; font-size: 12px; gap: 5px;
    }
    .edit-inputs { flex: 1; display: flex; flex-direction: column; gap: 10px; width: 100%; }

    /* CONTEXT MENU */
    .context-menu {
      position: absolute; background: #282828; border-radius: 4px; padding: 4px;
      box-shadow: 0 16px 24px rgba(0,0,0,0.5); z-index: 3000; min-width: 200px;
      display: none; flex-direction: column;
    }
    .context-menu.active { display: flex; }
    .ctx-item { padding: 12px; color: #eee; font-size: 14px; cursor: pointer; display: flex; align-items: center; gap: 12px; border-radius: 2px; }
    .ctx-item:hover { background: #3e3e3e; }

    /* RESPONSIVIDADE */
    @media (max-width: 768px) {
      body { height: auto; display: block; overflow: auto; }
      #sidebar { display: none; }
      #mobile-nav { display: flex; }
      
      #content { 
          padding: 16px; 
          margin: 0; 
          border-radius: 0; 
          padding-bottom: 200px; 
          height: auto;
          overflow: visible;
      }

      .top-bar { margin: 0 -16px 10px -16px; padding: 0 16px; height: 56px; }
      
      #main-wrapper { display: block; height: auto; overflow: visible; } 
      
      #player-bar { 
        position: fixed;
        bottom: var(--nav-height); height: 56px; 
        padding: 0 8px; background: rgba(20,20,20,0.98); 
        border-radius: 6px; margin: 0 8px 8px; 
        width: auto; left: 0; right: 0; border: none; z-index: 100;
        box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      }
      .player-center, .player-right { display: none; }
      .player-left { width: 100%; justify-content: space-between; }
      .mobile-mini-play { display: flex !important; font-size: 24px; margin-right: 10px; color: #fff; cursor: pointer; }
      
      #mini-like-btn { display: none !important; }

      .grid { grid-template-columns: 1fr 1fr; gap: 12px; }
      .genre-grid { grid-template-columns: 1fr 1fr; gap: 12px; }
      .genre-card { height: 100px; }
      .genre-title { font-size: 16px; padding: 12px; }
      .genre-img { width: 60px; height: 60px; }
      .genre-img i { font-size: 30px; }
      
      .track-list-item { 
          grid-template-columns: 1fr 40px; 
          padding: 8px 4px; 
          margin: 0;
      }
      .track-list-item div:nth-child(1), .track-list-item div:nth-child(5) { display: none; }
      .track-list-item div:nth-child(2) { display: none; }
      .track-list-item div:nth-child(2) { display: block; margin-right: 12px; }
      .track-list-item { display: flex; }
      .track-title { display: block !important; }

      .pl-cover-large { width: 180px; height: 180px; margin: 0 auto 20px; box-shadow: 0 8px 24px rgba(0,0,0,0.4); }
      .pl-header { flex-direction: column; align-items: center; text-align: center; }
      .pl-name { font-size: 28px; }
      .pl-details { align-items: center; }

      .edit-grid { flex-direction: column; align-items: center; text-align: center; }
      .edit-inputs { text-align: center; }
      
      /* BOTTOM SHEET MOBILE */
      .context-menu.active {
          position: fixed;
          bottom: 0;
          left: 0 !important;
          top: auto !important;
          width: 100%;
          border-radius: 16px 16px 0 0;
          animation: slideUp 0.3s ease;
          padding-bottom: 30px; 
          border-top: 1px solid rgba(255,255,255,0.1);
      }
      @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
      .ctx-item { padding: 16px 20px; font-size: 16px; }
    }
    .mobile-mini-play { display: none; }

  </style>
  <style>
      /* CSS Adicional para Animação de Carregamento e Slider */
      @keyframes pulse-opacity {
          0% { opacity: 1; }
          50% { opacity: 0.4; }
          100% { opacity: 1; }
      }

      .buffering-anim {
          animation: pulse-opacity 1.5s infinite ease-in-out;
      }

      /* Melhoria visual para garantir que o input range seja clicável */
      .sp-range {
          cursor: pointer;
          z-index: 10;
      }
